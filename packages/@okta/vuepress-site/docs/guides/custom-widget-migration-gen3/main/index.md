---
title: Migrate to the third generation (Gen3) of the Sign-In Widget
excerpt: Learn how to migrate to the third generation (Gen3) of the Sign-In Widget.
layout: Guides
---
<ApiLifecycle access="ie" />

This guide explains how to migrate from the second (Gen2) to the third generation (Gen3) of the Okta Sign-In Widget.

> **Note:** This document is only for Okta Identity Engine. See [Identify your Okta solution](https://help.okta.com/okta_help.htm?type=oie&id=ext-oie-version) to determine your Okta version.

---

#### Learning outcomes

* Upgrade from Gen2 to Gen3 of the Sign-In Widget.
* Use design tokens to adapt your existing customizations to Gen3.
* Use the recommended functions for Gen3.
* Roll back to the second generation, if necessary, without affecting other code in your Sign-In Widget template.


#### What you need

* [Okta Integrator Free Plan org](https://developer.okta.com/signup/)
* [Custom URL domain](/docs/guides/custom-url-domain/main/)
* [Node v12.22 or later, earlier than v16](https://nodejs.org/en/download/)

#### Sample code

[Gen3 design tokens - customization examples](/docs/guides/custom-widget-gen3/main/#customization-examples)

---

## About customizations of Gen3

Gen3 of the Sign-In Widget offers the same user experience as the second generation, and adds accessibility improvements in color contrast, focus management, and screen reader behavior. It establishes a foundation for improvements in customization and globalization.

Still, there are a few key differences between Gen2 and Gen3. Consider the following:

* [CSS and design tokens]()
* [jQuery and Preact]()

See [Sign-In Widget, third generation](https://help.okta.com/okta_help.htm?type=oie&id=ext-compare-siw) to verify if the third generation is right for your org.

### CSS and design tokens

Unlike [Gen2](/docs/guides/custom-widget/main/#style-for-redirect-authentication), Gen3 of the Sign-In Widget doesn’t use fixed CSS class names (className). See [Custom buttons](/docs/guides/custom-widget/main/#custom-buttons) for an example.

You can still use CSS to style Gen3 of the Sign-In Widget. However, without fixed `className` selectors, you can’t reliably style widget elements with `className`-based overrides.

Instead, Gen3 uses [design tokens](/docs/guides/custom-widget-gen3/main/#use-design-tokens).

Design tokens make the Sign-In Widget's visual style consistent and easier to update. Tokens replace static values to customize the following:
* Color
* Border
* Font family
* Font size
* Font weight
* Line height
* Spacing

See [Customization Examples](/docs/guides/custom-widget-gen3/main/#customization-examples).

> **Note:** Gen3 also offers autogenerated palettes that preserve accessible color contrast ratios. See the [Odyssey by Okta design system](https://odyssey.okta.design/latest/foundations/accessibility/color-9O9a4XAU) and [Palette generation and accessibility](/docs/guides/custom-widget-gen3/main/#palette-generation-and-accessibility).

### jQuery and Preact

Gen3 is built on [Preact](https://preactjs.com/), a lightweight [React Native](https://reactnative.dev/) alternative. The architecture changes from jQuery-based (Gen2) to Preact-based (Gen3). As a result, each generation of the Sign-In Widget handles DOM manipulations in a different way.

For example, the `afterRender` function doesn’t work in Gen3 as it does in Gen2. See [About afterTransform and afterRender](#about-aftertransform-and-afterrender) for more information.

## Upgrade to Gen3

You can upgrade to Gen3 in a few different ways:

* Use the Admin Console.
* Use the API.

> **Note:** If you have a new Identity Engine org, Gen3 isn't enabled by default.

### Use the Admin Console

To upgrade to Gen3:

1. In the **Admin Console**, go to **Customizations** > **Brands**.
1. Select a brand.
1. Go to the **Pages** tab, and then click **Edit** or **Configure** for the **Sign-in page**.
1. Click the **Settings** tab.
1. In the **Sign-In Widget version** section, click **Edit**.
1. Turn on the **Use the third generation** toggle.
1. Click **Save to draft**.
1. Click **Publish**.

See [Brands](/docs/concepts/brands/) for more details about brands in Okta.

### Use the API

Send a PUT request to the `https://{yourOktaDomain}/api/v1/brands/{brandId}/pages/sign-in/customized` endpoint. Include the following:

* Provide a value for the domain:
  * If you want to upgrade the `widgetGeneration` of your default [brand](/docs/concepts/brands/), use the value of your org domain. See [Find your Okta domain](/docs/guides/find-your-domain/main/#find-your-okta-domain).
  * If you want to upgrade another brand in your org, use the custom domain associated with the brand. See [About Okta domain customization](/docs/guides/custom-url-domain/main/#about-okta-domain-customization).
* Provide a value for `brandId`. Ensure that it’s the ID associated with the domain or custom domain that you want to upgrade.
* In the `widgetCustomizations` object, set `widgetGeneration` to `G3`. See [widgetGeneration](https://developer.okta.com/docs/api/openapi/okta-management/management/tag/CustomPages/#tag/CustomPages/operation/replaceCustomizedSignInPage!path=widgetCustomizations/widgetGeneration&t=request).

See [Replace the customized sign-in page](https://developer.okta.com/docs/api/openapi/okta-management/management/tag/CustomPages/#tag/CustomPages/operation/replaceCustomizedSignInPage!path=widgetCustomizations/widgetGeneration&t=request) for more details.

## Add design tokens to your code

Use the code editor to add design tokens to your code. See [Use the code editor (Gen3)](/docs/guides/custom-widget-gen3/main/#use-the-code-editor).

### Design token examples

Pass the design token values into the `OktaSignIn` constructor. For example:

```javascript
new OktaSignIn({
  theme: {
    tokens: {
      PalettePrimaryMain: '#D11DCA',
      TypographyColorBody: '#00297A',
      TypographyColorHeading: '#00297A',
      TypographyFamilyHeading: 'Helvetica',
      TypographyFamilyBody: 'Helvetica',
      TypographyWeightHeading: 600,
      BorderRadiusMain: '24px',
      Spacing5: '2.85714286rem',
    }
  }
});
```

See [Customization examples](/docs/guides/custom-widget-gen3/main/#customization-examples) for more information.

## Use the useSiwGen3 variable

The `useSiwGen3` [variable](/docs/guides/custom-widget/main/#use-variables) is a conditional that allows you to set behaviors for a migration to Gen3.

Use `useSiwGen3` to add specific code that works when you enable Gen3, but doesn't affect other code in the template if you need to roll back to Gen2.

> **Note:** If your org uses Classic Engine, the `useSiwGen3` variable appears in the code editor, but you can't use it.

The following example shows how to style the `okta-login-container` for a migration to Gen3:

```html
{{#useSiwGen3}}
    <style nonce="{{nonceValue}}">
        #okta-login-container {
            background-color: red !important;
        }
    </style>
{{/useSiwGen3}}
```

## About afterTransform and afterRender

The [afterRender](https://github.com/okta/okta-signin-widget?tab=readme-ov-file#afterrender) function doesn’t work with Gen3 as it does with Gen2. In Gen3, if you use `afterRender` for DOM manipulations, the Okta Sign-In Widget reverts any customizations to default settings. See [jQuery and Preact](#jquery-and-preact).

The `afterTransform` function is the recommended way to apply DOM customizations in Gen3.

To use the `afterTransform` function, see [Use the afterTransform function (recommended)](#use-the-aftertransform-function-recommended).
To keep using the `afterRender` function, see [Use the afterRender function (not recommended)](#use-the-afterrender-function-not-recommended).

### Use the afterTransform function (recommended)

The third-generation Sign-In Widget introduces a new function: `afterTransform()`. See [jQuery and Preact](#jquery-and-preact).

The function takes two arguments:

* The name of the form to customize
* A function that receives a context argument with the changes

`signIn.afterTransform('form_name', function (context) { }`

`afterTransform` doesn’t update the DOM after components are already rendered. Instead, it allows you to modify the `formBag` object sent to the components. The `formBag` controls what the components render.

Consider the following examples:

* [Change button text](#change-button-text-examples)
* [Remove an unused link](#remove-an-unused-link-example)
* [Add an instructional paragraph](#add-an-instructional-paragraph-example)

> **Note:** Supplying a wildcard (`*`) for the `form_name` matches all forms. You can't use a wildcard for partial name matches.

#### Change button text examples

The following example shows how to change the text of the **Submit** button to **Login** on the **Identify** page:

```javascript
oktaSignIn.afterTransform('identify', ({ formBag }) => {
 const submitIndex = formBag.uischema.elements.findIndex(ele => ele.type === 'Button' && ele.options.type === 'submit');
 if (submitIndex != -1) {
   const submit = formBag.uischema.elements[submitIndex];
   submit.label = 'Login';
 }
});
```

The following example shows how to change the text of the **Submit** button to **Register** on the **Enroll profile** page:

```javascript
oktaSignIn.afterTransform('enroll-profile', ({ formBag }) => {
   const submitIndex = formBag.uischema.elements.findIndex(ele => ele.type === 'Button' && ele.options.type === 'submit');
   if (submitIndex != -1) {
       const submit = formBag.uischema.elements[submitIndex];
       submit.label = 'Register';
   }
});
```

#### Remove an unused link example

The following example shows how to remove the **Help**, **Unlock account?**, and **Forgot password?** links from the **Identify** page:

```javascript
oktaSignIn.afterTransform('identify', ({ formBag }) => {
 const help = formBag.uischema.elements.find(ele => ele.type === 'Link' && ele.options.dataSe === 'help');
 const unlock = formBag.uischema.elements.find(ele => ele.type === 'Link' && ele.options.dataSe === 'unlock');
 const forgot = formBag.uischema.elements.find(ele => ele.type === 'Link' && ele.options.dataSe === 'forgot-password');
 formBag.uischema.elements = formBag.uischema.elements.filter(ele => ![help, unlock, forgot].includes(ele));
});
```

#### Add an instructional paragraph example

The following example shows how to add a custom description to the **Password recovery** page:

```javascript
oktaSignIn.afterTransform?.('identify-recovery', ({ formBag }) => {
   const titleIndex = formBag.uischema.elements.findIndex(ele => ele.type === 'Title');
   // Add custom description after title
   const descr = {
       type: 'Description',
       contentType: 'subtitle',
       options: {
           variant: 'body1',
           content: '<div class=\'my-reset-description\'>Description<br />about<br />recovery</div>'
       },
   };
   if (titleIndex != -1) {
       formBag.uischema.elements.splice(titleIndex + 1, 0, descr);
   }
});
```

### Use the afterRender function (not recommended)




#### Use MutationObserver for DOM manipulations



#### Use afterRender for non-DOM manipulations




## See also

